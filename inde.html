<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chassis Systems Revision Guide</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        body {
            margin: 0;
            padding: 10px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            font-size: 24px;
            margin-top: 10px;
        }
        h2 {
            color: #3498db;
            font-size: 20px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
            margin-top: 25px;
        }
        h3 {
            color: #2c3e50;
            font-size: 18px;
        }
        .section {
            background: white;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .instructions {
            background: #e8f4fc;
            padding: 10px;
            border-left: 4px solid #3498db;
            margin-bottom: 15px;
        }
        textarea, input[type="text"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        textarea {
            min-height: 80px;
            resize: vertical;
        }
        .component-item {
            margin-bottom: 15px;
        }
        .key-term {
            display: flex;
            margin-bottom: 10px;
        }
        .key-term input:first-child {
            width: 30%;
            margin-right: 10px;
        }
        .key-term input:last-child {
            width: 70%;
        }
        .mind-map {
            background: #f9f9f9;
            border: 1px dashed #ccc;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
        }
        .mind-map-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .mind-map-branch {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .mind-map-category {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .mind-map-category input {
            flex-grow: 1;
        }
        .mind-map-details {
            margin-left: 30px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .rating {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
        }
        .rating span {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 14px;
        }
        .add-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px 0;
        }
        .remove-button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 3px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 5px;
        }
        .scenario {
            background: #f0f0f0;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
        }
        .scenario-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .cause-item, .procedure-item {
            display: flex;
            margin-bottom: 5px;
        }
        .cause-item input, .procedure-item input {
            flex-grow: 1;
        }
        hr {
            border: 0;
            height: 1px;
            background: #ddd;
            margin: 20px 0;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .checkbox-item input[type="checkbox"] {
            margin-right: 10px;
        }
        .checkbox-item input[type="text"] {
            flex-grow: 1;
        }
        .tab-container {
            margin-bottom: 15px;
        }
        .tab-buttons {
            display: flex;
            overflow-x: auto;
            border-bottom: 1px solid #ddd;
        }
        .tab-button {
            padding: 10px 15px;
            background: #f1f1f1;
            border: none;
            cursor: pointer;
            font-size: 16px;
            flex-shrink: 0;
        }
        .tab-button.active {
            background: #3498db;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 15px;
            background: #fff;
            border: 1px solid #ddd;
            border-top: none;
        }
        .tab-content.active {
            display: block;
        }
        .notes-container {
            margin-bottom: 15px;
        }
        .save-button {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin: 20px 0;
        }
        .task-timer {
            background: #34495e;
            color: white;
            padding: 10px;
            text-align: center;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        @media (max-width: 600px) {
            .key-term {
                flex-direction: column;
            }
            .key-term input:first-child, .key-term input:last-child {
                width: 100%;
                margin-right: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Chassis Systems Mastery Guide</h1>
        <p style="text-align: center;">Interactive Revision Workshop</p>
        
        <div class="task-timer">
            <h3 style="margin: 0; color: white;">Time Spent</h3>
            <div id="timer">00:00:00</div>
        </div>

        <div class="tab-container">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="openTab(event, 'intro')">Intro</button>
                <button class="tab-button" onclick="openTab(event, 'part1')">Part 1</button>
                <button class="tab-button" onclick="openTab(event, 'part2')">Part 2</button>
                <button class="tab-button" onclick="openTab(event, 'part3')">Part 3</button>
                <button class="tab-button" onclick="openTab(event, 'part4')">Part 4</button>
                <button class="tab-button" onclick="openTab(event, 'assessment')">Self-Assessment</button>
            </div>
            
            <div id="intro" class="tab-content active">
                <h2>Introduction</h2>
                <div class="instructions">
                    <p>This interactive workshop will help you create revision materials for the upcoming chassis systems exam. Work through each section to build a comprehensive study guide.</p>
                    <p>By the end, you'll have materials covering Steering, Suspension, Brakes, and Wheels/Tyres.</p>
                </div>
                
                <h3>Select Your System:</h3>
                <select id="system-select" style="width: 100%; padding: 10px; margin-bottom: 15px; font-size: 16px;">
                    <option value="">-- Select your assigned system --</option>
                    <option value="Steering">Steering</option>
                    <option value="Suspension">Suspension</option>
                    <option value="Brakes">Brakes</option>
                    <option value="Wheels and Tyres">Wheels and Tyres</option>
                </select>
                
                <p>Click on the tabs above to navigate through each part of the workshop.</p>
                <button onclick="openTab(null, 'part1')" style="background: #3498db; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer; width: 100%;">Start Workshop</button>
            </div>
            
            <div id="part1" class="tab-content">
                <h2>Part 1: Knowledge Organization (30 minutes)</h2>
                <div class="instructions">
                    <p>Create a mind map for your assigned system. Add components, operation principles, advantages, defects, and inspection procedures.</p>
                </div>
                
                <h3>Your System: <span id="selected-system-display">Not Selected</span></h3>
                
                <div class="mind-map-container">
                    <h3>Components</h3>
                    <div id="components-container">
                        <div class="mind-map-details">
                            <input type="text" placeholder="Enter component 1">
                            <input type="text" placeholder="Enter component 2">
                            <input type="text" placeholder="Enter component 3">
                        </div>
                        <button class="add-button" onclick="addMindMapItem('components-container')">+ Add Component</button>
                    </div>
                    
                    <h3>Operation Principles</h3>
                    <div id="operation-container">
                        <div class="mind-map-details">
                            <input type="text" placeholder="Enter operation principle 1">
                            <input type="text" placeholder="Enter operation principle 2">
                            <input type="text" placeholder="Enter operation principle 3">
                        </div>
                        <button class="add-button" onclick="addMindMapItem('operation-container')">+ Add Principle</button>
                    </div>
                    
                    <h3>Advantages</h3>
                    <div id="advantages-container">
                        <div class="mind-map-details">
                            <input type="text" placeholder="Enter advantage 1">
                            <input type="text" placeholder="Enter advantage 2">
                            <input type="text" placeholder="Enter advantage 3">
                        </div>
                        <button class="add-button" onclick="addMindMapItem('advantages-container')">+ Add Advantage</button>
                    </div>
                    
                    <h3>Common Defects</h3>
                    <div id="defects-container">
                        <div class="mind-map-details">
                            <input type="text" placeholder="Enter defect 1">
                            <input type="text" placeholder="Enter defect 2">
                            <input type="text" placeholder="Enter defect 3">
                        </div>
                        <button class="add-button" onclick="addMindMapItem('defects-container')">+ Add Defect</button>
                    </div>
                    
                    <h3>Inspection Procedures</h3>
                    <div id="procedures-container">
                        <div class="mind-map-details">
                            <input type="text" placeholder="Enter procedure 1">
                            <input type="text" placeholder="Enter procedure 2">
                            <input type="text" placeholder="Enter procedure 3">
                        </div>
                        <button class="add-button" onclick="addMindMapItem('procedures-container')">+ Add Procedure</button>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                    <button onclick="openTab(null, 'intro')" style="background: #95a5a6; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer;">Previous</button>
                    <button onclick="openTab(null, 'part2')" style="background: #3498db; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer;">Next: Diagnostic Challenges</button>
                </div>
            </div>
            
            <div id="part2" class="tab-content">
                <h2>Part 2: Diagnostic Challenges (40 minutes)</h2>
                <div class="instructions">
                    <p>Create 3-5 diagnostic scenarios for your assigned system. Include symptoms, possible causes, inspection procedures, and recommended repairs.</p>
                </div>
                
                <div id="scenarios-container">
                    <div class="scenario">
                        <div class="scenario-title">Scenario 1</div>
                        <div>
                            <p>Vehicle symptoms:</p>
                            <textarea placeholder="Describe the symptoms a vehicle might present..."></textarea>
                            
                            <p>Possible causes:</p>
                            <div id="causes-container-1">
                                <div class="cause-item">
                                    <input type="text" placeholder="Possible cause 1">
                                </div>
                                <div class="cause-item">
                                    <input type="text" placeholder="Possible cause 2">
                                </div>
                                <div class="cause-item">
                                    <input type="text" placeholder="Possible cause 3">
                                </div>
                            </div>
                            <button class="add-button" onclick="addCauseItem('causes-container-1')">+ Add Cause</button>
                            
                            <p>Inspection procedures:</p>
                            <div id="procedures-container-1">
                                <div class="procedure-item">
                                    <input type="text" placeholder="Inspection procedure 1">
                                </div>
                                <div class="procedure-item">
                                    <input type="text" placeholder="Inspection procedure 2">
                                </div>
                                <div class="procedure-item">
                                    <input type="text" placeholder="Inspection procedure 3">
                                </div>
                            </div>
                            <button class="add-button" onclick="addProcedureItem('procedures-container-1')">+ Add Procedure</button>
                            
                            <p>Recommended repairs:</p>
                            <textarea placeholder="Describe the recommended repairs..."></textarea>
                        </div>
                    </div>
                </div>
                <button class="add-button" onclick="addScenario()">+ Add New Scenario</button>
                
                <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                    <button onclick="openTab(null, 'part1')" style="background: #95a5a6; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer;">Previous</button>
                    <button onclick="openTab(null, 'part3')" style="background: #3498db; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer;">Next: Visual Reference Guide</button>
                </div>
            </div>
            
            <div id="part3" class="tab-content">
                <h2>Part 3: Visual Reference Guide (30 minutes)</h2>
                <div class="instructions">
                    <p>Create a quick reference guide for your assigned system including key components, common defects, terminology, and an inspection checklist.</p>
                </div>
                
                <h3>Key Components</h3>
                <div id="key-components-container">
                    <div class="component-item">
                        <input type="text" placeholder="Component 1 and brief description">
                    </div>
                    <div class="component-item">
                        <input type="text" placeholder="Component 2 and brief description">
                    </div>
                    <div class="component-item">
                        <input type="text" placeholder="Component 3 and brief description">
                    </div>
                    <div class="component-item">
                        <input type="text" placeholder="Component 4 and brief description">
                    </div>
                    <div class="component-item">
                        <input type="text" placeholder="Component 5 and brief description">
                    </div>
                </div>
                <button class="add-button" onclick="addComponent()">+ Add Component</button>
                
                <h3>Component Diagram Notes</h3>
                <textarea placeholder="Describe your diagram here, noting key parts and their relationships..."></textarea>
                
                <h3>Common Defects</h3>
                <div id="defects-list-container">
                    <div class="key-term">
                        <input type="text" placeholder="Symptom">
                        <input type="text" placeholder="Likely Cause">
                    </div>
                    <div class="key-term">
                        <input type="text" placeholder="Symptom">
                        <input type="text" placeholder="Likely Cause">
                    </div>
                    <div class="key-term">
                        <input type="text" placeholder="Symptom">
                        <input type="text" placeholder="Likely Cause">
                    </div>
                    <div class="key-term">
                        <input type="text" placeholder="Symptom">
                        <input type="text" placeholder="Likely Cause">
                    </div>
                </div>
                <button class="add-button" onclick="addDefect()">+ Add Defect</button>
                
                <h3>Key Terminology</h3>
                <div id="terminology-container">
                    <div class="key-term">
                        <input type="text" placeholder="Term">
                        <input type="text" placeholder="Definition">
                    </div>
                    <div class="key-term">
                        <input type="text" placeholder="Term">
                        <input type="text" placeholder="Definition">
                    </div>
                    <div class="key-term">
                        <input type="text" placeholder="Term">
                        <input type="text" placeholder="Definition">
                    </div>
                    <div class="key-term">
                        <input type="text" placeholder="Term">
                        <input type="text" placeholder="Definition">
                    </div>
                    <div class="key-term">
                        <input type="text" placeholder="Term">
                        <input type="text" placeholder="Definition">
                    </div>
                </div>
                <button class="add-button" onclick="addTerm()">+ Add Term</button>
                
                <h3>Inspection Checklist</h3>
                <div id="checklist-container">
                    <div class="checkbox-item">
                        <input type="checkbox">
                        <input type="text" placeholder="Inspection item 1">
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox">
                        <input type="text" placeholder="Inspection item 2">
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox">
                        <input type="text" placeholder="Inspection item 3">
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox">
                        <input type="text" placeholder="Inspection item 4">
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox">
                        <input type="text" placeholder="Inspection item 5">
                    </div>
                </div>
                <button class="add-button" onclick="addChecklistItem()">+ Add Checklist Item</button>
                
                <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                    <button onclick="openTab(null, 'part2')" style="background: #95a5a6; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer;">Previous</button>
                    <button onclick="openTab(null, 'part4')" style="background: #3498db; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer;">Next: Knowledge Sharing</button>
                </div>
            </div>
            
            <div id="part4" class="tab-content">
                <h2>Part 4: Knowledge Sharing (20 minutes)</h2>
                <div class="instructions">
                    <p>Prepare to share the 3 most important points about your system. As others present, take notes in the spaces below.</p>
                </div>
                
                <h3>Your Key Points to Share</h3>
                <div>
                    <input type="text" placeholder="Key point 1">
                    <input type="text" placeholder="Key point 2">
                    <input type="text" placeholder="Key point 3">
                </div>
                
                <h3>Notes from Other Presentations</h3>
                <div class="notes-container">
                    <h4>Steering System</h4>
                    <textarea placeholder="Note key points from the Steering presentation..."></textarea>
                    
                    <h4>Suspension System</h4>
                    <textarea placeholder="Note key points from the Suspension presentation..."></textarea>
                    
                    <h4>Braking System</h4>
                    <textarea placeholder="Note key points from the Brakes presentation..."></textarea>
                    
                    <h4>Wheels and Tyres</h4>
                    <textarea placeholder="Note key points from the Wheels and Tyres presentation..."></textarea>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                    <button onclick="openTab(null, 'part3')" style="background: #95a5a6; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer;">Previous</button>
                    <button onclick="openTab(null, 'assessment')" style="background: #3498db; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer;">Next: Self-Assessment</button>
                </div>
            </div>
            
            <div id="assessment" class="tab-content">
                <h2>Self-Assessment</h2>
                <div class="instructions">
                    <p>Rate your confidence in each system and identify your revision priorities.</p>
                </div>
                
                <h3>Confidence Rating (1-5, with 5 being most confident)</h3>
                
                <div class="rating">
                    <span>Steering<br>
                        <select style="margin-top: 5px;">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                    </span>
                    <span>Suspension<br>
                        <select style="margin-top: 5px;">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                    </span>
                    <span>Brakes<br>
                        <select style="margin-top: 5px;">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                    </span>
                    <span>Wheels & Tyres<br>
                        <select style="margin-top: 5px;">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                    </span>
                </div>
                
                <h3>My Exam Revision Priorities</h3>
                <div id="priorities-container">
                    <input type="text" placeholder="Priority 1">
                    <input type="text" placeholder="Priority 2">
                    <input type="text" placeholder="Priority 3">
                </div>
                <button class="add-button" onclick="addPriority()">+ Add Priority</button>
                
                <h3>Additional Notes</h3>
                <textarea placeholder="Any other notes about what you need to focus on..."></textarea>
                
                <h3>Instructor Contact</h3>
                <div style="margin-bottom: 20px;">
                    <label for="instructor-email">Instructor's Email Address:</label>
                    <input type="email" id="instructor-email" placeholder="Enter your instructor's email" style="width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ddd; border-radius: 4px;">
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="save-button" onclick="saveWorksheet()">Save My Revision Guide</button>
                    <button class="save-button" onclick="downloadSummary()" style="background: #2980b9;">Download Summary</button>
                    <button class="save-button" onclick="emailToInstructor()" style="background: #27ae60;">Email to Instructor</button>
                </div>
                
                <div style="display: flex; justify-content: flex-start; margin-top: 20px;">
                    <button onclick="openTab(null, 'part4')" style="background: #95a5a6; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer;">Previous</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // System selection
        document.getElementById('system-select').addEventListener('change', function() {
            const selectedSystem = this.value;
            const displays = document.querySelectorAll('#selected-system-display');
            displays.forEach(display => {
                display.textContent = selectedSystem;
            });
        });
        
        // Tab navigation
        function openTab(evt, tabName) {
            const tabContents = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
            
            const tabButtons = document.getElementsByClassName("tab-button");
            for (let i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            
            if (evt) {
                evt.currentTarget.classList.add("active");
            } else {
                // Find the button for this tab and activate it
                const buttons = document.getElementsByClassName("tab-button");
                for (let i = 0; i < buttons.length; i++) {
                    if (buttons[i].textContent.toLowerCase().includes(tabName.replace("part", "part "))) {
                        buttons[i].classList.add("active");
                        break;
                    }
                }
            }
        }
        
        // Add mind map item
        function addMindMapItem(containerId) {
            const container = document.getElementById(containerId);
            const details = container.querySelector('.mind-map-details');
            const input = document.createElement('input');
            input.type = 'text';
            input.placeholder = 'Enter new item';
            details.appendChild(input);
        }
        
        // Add scenario
        function addScenario() {
            const container = document.getElementById('scenarios-container');
            const scenarioCount = container.children.length + 1;
            
            const scenarioDiv = document.createElement('div');
            scenarioDiv.className = 'scenario';
            
            const causesContainerId = `causes-container-${scenarioCount}`;
            const proceduresContainerId = `procedures-container-${scenarioCount}`;
            
            scenarioDiv.innerHTML = `
                <div class="scenario-title">Scenario ${scenarioCount}</div>
                <div>
                    <p>Vehicle symptoms:</p>
                    <textarea placeholder="Describe the symptoms a vehicle might present..."></textarea>
                    
                    <p>Possible causes:</p>
                    <div id="${causesContainerId}">
                        <div class="cause-item">
                            <input type="text" placeholder="Possible cause 1">
                        </div>
                        <div class="cause-item">
                            <input type="text" placeholder="Possible cause 2">
                        </div>
                        <div class="cause-item">
                            <input type="text" placeholder="Possible cause 3">
                        </div>
                    </div>
                    <button class="add-button" onclick="addCauseItem('${causesContainerId}')">+ Add Cause</button>
                    
                    <p>Inspection procedures:</p>
                    <div id="${proceduresContainerId}">
                        <div class="procedure-item">
                            <input type="text" placeholder="Inspection procedure 1">
                        </div>
                        <div class="procedure-item">
                            <input type="text" placeholder="Inspection procedure 2">
                        </div>
                        <div class="procedure-item">
                            <input type="text" placeholder="Inspection procedure 3">
                        </div>
                    </div>
                    <button class="add-button" onclick="addProcedureItem('${proceduresContainerId}')">+ Add Procedure</button>
                    
                    <p>Recommended repairs:</p>
                    <textarea placeholder="Describe the recommended repairs..."></textarea>
                </div>
            `;
            
            container.appendChild(scenarioDiv);
        }
        
        // Add cause item
        function addCauseItem(containerId) {
            const container = document.getElementById(containerId);
            const causeItem = document.createElement('div');
            causeItem.className = 'cause-item';
            causeItem.innerHTML = `<input type="text" placeholder="Possible cause">`;
            container.appendChild(causeItem);
        }
        
        // Add procedure item
        function addProcedureItem(containerId) {
            const container = document.getElementById(containerId);
            const procedureItem = document.createElement('div');
            procedureItem.className = 'procedure-item';
            procedureItem.innerHTML = `<input type="text" placeholder="Inspection procedure">`;
            container.appendChild(procedureItem);
        }
        
        // Add component
        function addComponent() {
            const container = document.getElementById('key-components-container');
            const componentItem = document.createElement('div');
            componentItem.className = 'component-item';
            componentItem.innerHTML = `<input type="text" placeholder="Component and brief description">`;
            container.appendChild(componentItem);
        }
        
        // Add defect
        function addDefect() {
            const container = document.getElementById('defects-list-container');
            const defectItem = document.createElement('div');
            defectItem.className = 'key-term';
            defectItem.innerHTML = `
                <input type="text" placeholder="Symptom">
                <input type="text" placeholder="Likely Cause">
            `;
            container.appendChild(defectItem);
        }
        
        // Add term
        function addTerm() {
            const container = document.getElementById('terminology-container');
            const termItem = document.createElement('div');
            termItem.className = 'key-term';
            termItem.innerHTML = `
                <input type="text" placeholder="Term">
                <input type="text" placeholder="Definition">
            `;
            container.appendChild(termItem);
        }
        
        // Add checklist item
        function addChecklistItem() {
            const container = document.getElementById('checklist-container');
            const checklistItem = document.createElement('div');
            checklistItem.className = 'checkbox-item';
            checklistItem.innerHTML = `
                <input type="checkbox">
                <input type="text" placeholder="Inspection item">
            `;
            container.appendChild(checklistItem);
        }
        
        // Add priority
        function addPriority() {
            const container = document.getElementById('priorities-container');
            const input = document.createElement('input');
            input.type = 'text';
            input.placeholder = 'Additional priority';
            container.appendChild(input);
        }
        
        // Save worksheet to local storage
        function saveWorksheet() {
            const data = gatherAllData();
            localStorage.setItem('chassisWorksheet', JSON.stringify(data));
            alert('Your revision guide has been saved to your device! You can continue later where you left off.');
        }
        
        // Download summary as text file
        function downloadSummary() {
            const data = gatherAllData();
            const summary = generateSummaryText(data);
            
            // Create a blob and download link
            const blob = new Blob([summary], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Chassis_Systems_Summary.txt';
            document.body.appendChild(a);
            a.click();
            
            // Clean up
            setTimeout(function() {
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            }, 0);
        }
        
        // Email to instructor
        function emailToInstructor() {
            const instructorEmail = document.getElementById('instructor-email').value;
            
            if (!instructorEmail) {
                alert('Please enter your instructor\'s email address first.');
                return;
            }
            
            const data = gatherAllData();
            const summary = generateSummaryText(data);
            
            // Create email body with encoded content
            const studentName = prompt("Please enter your full name:", "");
            const subject = studentName ? `Chassis Systems Revision - ${studentName}` : "Chassis Systems Revision Summary";
            const emailBody = encodeURIComponent("Please find my completed Chassis Systems revision summary below:\n\n" + summary);
            
            // Open default email client with pre-filled content
            window.location.href = `mailto:${encodeURIComponent(instructorEmail)}?subject=${encodeURIComponent(subject)}&body=${emailBody}`;
        }
        
        // Gather all data from the form
        function gatherAllData() {
            const system = document.getElementById('system-select').value;
            
            // Mind map data
            const components = Array.from(document.querySelectorAll('#components-container input')).map(input => input.value);
            const operations = Array.from(document.querySelectorAll('#operation-container input')).map(input => input.value);
            const advantages = Array.from(document.querySelectorAll('#advantages-container input')).map(input => input.value);
            const defects = Array.from(document.querySelectorAll('#defects-container input')).map(input => input.value);
            const procedures = Array.from(document.querySelectorAll('#procedures-container input')).map(input => input.value);
            
            // Scenarios data
            const scenarios = [];
            const scenarioDivs = document.querySelectorAll('#scenarios-container .scenario');
            scenarioDivs.forEach((div, index) => {
                const symptoms = div.querySelector('textarea:nth-of-type(1)').value;
                const causes = Array.from(div.querySelectorAll(`#causes-container-${index+1} input`)).map(input => input.value);
                const inspections = Array.from(div.querySelectorAll(`#procedures-container-${index+1} input`)).map(input => input.value);
                const repairs = div.querySelector('textarea:nth-of-type(2)').value;
                
                scenarios.push({
                    symptoms,
                    causes,
                    inspections,
                    repairs
                });
            });
            
            // Visual reference guide data
            const keyComponents = Array.from(document.querySelectorAll('#key-components-container input')).map(input => input.value);
            const diagramNotes = document.querySelector('#part3 textarea:nth-of-type(1)').value;
            
            const commonDefects = [];
            const defectRows = document.querySelectorAll('#defects-list-container .key-term');
            defectRows.forEach(row => {
                const inputs = row.querySelectorAll('input');
                if (inputs[0].value || inputs[1].value) {
                    commonDefects.push({
                        symptom: inputs[0].value,
                        cause: inputs[1].value
                    });
                }
            });
            
            const terminology = [];
            const termRows = document.querySelectorAll('#terminology-container .key-term');
            termRows.forEach(row => {
                const inputs = row.querySelectorAll('input');
                if (inputs[0].value || inputs[1].value) {
                    terminology.push({
                        term: inputs[0].value,
                        definition: inputs[1].value
                    });
                }
            });
            
            const checklist = [];
            const checkboxItems = document.querySelectorAll('#checklist-container .checkbox-item');
            checkboxItems.forEach(item => {
                const checked = item.querySelector('input[type="checkbox"]').checked;
                const text = item.querySelector('input[type="text"]').value;
                if (text) {
                    checklist.push({
                        done: checked,
                        text: text
                    });
                }
            });
            
            // Knowledge sharing data
            const keyPoints = Array.from(document.querySelectorAll('#part4 input[type="text"]')).map(input => input.value);
            const steeringNotes = document.querySelector('#part4 textarea:nth-of-type(1)').value;
            const suspensionNotes = document.querySelector('#part4 textarea:nth-of-type(2)').value;
            const brakesNotes = document.querySelector('#part4 textarea:nth-of-type(3)').value;
            const wheelsNotes = document.querySelector('#part4 textarea:nth-of-type(4)').value;
            
            // Self-assessment data
            const ratings = {
                steering: document.querySelector('#assessment select:nth-of-type(1)').value,
                suspension: document.querySelector('#assessment select:nth-of-type(2)').value,
                brakes: document.querySelector('#assessment select:nth-of-type(3)').value,
                wheelsAndTyres: document.querySelector('#assessment select:nth-of-type(4)').value
            };
            
            const priorities = Array.from(document.querySelectorAll('#priorities-container input')).map(input => input.value);
            const additionalNotes = document.querySelector('#assessment textarea').value;
            
            return {
                system,
                mindMap: {
                    components,
                    operations,
                    advantages,
                    defects,
                    procedures
                },
                scenarios,
                referenceGuide: {
                    keyComponents,
                    diagramNotes,
                    commonDefects,
                    terminology,
                    checklist
                },
                knowledgeSharing: {
                    keyPoints,
                    steeringNotes,
                    suspensionNotes,
                    brakesNotes,
                    wheelsNotes
                },
                assessment: {
                    ratings,
                    priorities,
                    additionalNotes
                }
            };
        }
        
        // Generate formatted text summary
        function generateSummaryText(data) {
            const summary = [];
            
            // Header
            summary.push("# CHASSIS SYSTEMS REVISION SUMMARY");
            summary.push(`## ${data.system || "Not specified"} System\n`);
            
            // Mind Map
            summary.push("## KNOWLEDGE ORGANIZATION");
            
            summary.push("### Components:");
            data.mindMap.components.forEach(item => {
                if (item) summary.push(`- ${item}`);
            });
            
            summary.push("\n### Operation Principles:");
            data.mindMap.operations.forEach(item => {
                if (item) summary.push(`- ${item}`);
            });
            
            summary.push("\n### Advantages:");
            data.mindMap.advantages.forEach(item => {
                if (item) summary.push(`- ${item}`);
            });
            
            summary.push("\n### Common Defects:");
            data.mindMap.defects.forEach(item => {
                if (item) summary.push(`- ${item}`);
            });
            
            summary.push("\n### Inspection Procedures:");
            data.mindMap.procedures.forEach(item => {
                if (item) summary.push(`- ${item}`);
            });
            
            // Scenarios
            summary.push("\n\n## DIAGNOSTIC SCENARIOS");
            
            data.scenarios.forEach((scenario, index) => {
                summary.push(`\n### Scenario ${index + 1}:`);
                summary.push(`Vehicle Symptoms: ${scenario.symptoms || "Not specified"}`);
                
                summary.push("\nPossible Causes:");
                scenario.causes.forEach(cause => {
                    if (cause) summary.push(`- ${cause}`);
                });
                
                summary.push("\nInspection Procedures:");
                scenario.inspections.forEach(procedure => {
                    if (procedure) summary.push(`- ${procedure}`);
                });
                
                summary.push(`\nRecommended Repairs: ${scenario.repairs || "Not specified"}`);
            });
            
            // Visual Reference Guide
            summary.push("\n\n## VISUAL REFERENCE GUIDE");
            
            summary.push("\n### Key Components:");
            data.referenceGuide.keyComponents.forEach(component => {
                if (component) summary.push(`- ${component}`);
            });
            
            summary.push(`\n### Component Diagram Notes:\n${data.referenceGuide.diagramNotes || "No notes provided"}`);
            
            summary.push("\n### Common Defects:");
            data.referenceGuide.commonDefects.forEach(defect => {
                if (defect.symptom || defect.cause) {
                    summary.push(`- Symptom: ${defect.symptom || "Not specified"} | Cause: ${defect.cause || "Not specified"}`);
                }
            });
            
            summary.push("\n### Key Terminology:");
            data.referenceGuide.terminology.forEach(term => {
                if (term.term || term.definition) {
                    summary.push(`- ${term.term || "Term"}: ${term.definition || "No definition provided"}`);
                }
            });
            
            summary.push("\n### Inspection Checklist:");
            data.referenceGuide.checklist.forEach(item => {
                if (item.text) {
                    summary.push(`- [${item.done ? "X" : " "}] ${item.text}`);
                }
            });
            
            // Knowledge Sharing
            summary.push("\n\n## KNOWLEDGE SHARING");
            
            summary.push("\n### Key Points to Share:");
            data.knowledgeSharing.keyPoints.forEach(point => {
                if (point) summary.push(`- ${point}`);
            });
            
            summary.push(`\n### Steering System Notes:\n${data.knowledgeSharing.steeringNotes || "No notes provided"}`);
            summary.push(`\n### Suspension System Notes:\n${data.knowledgeSharing.suspensionNotes || "No notes provided"}`);
            summary.push(`\n### Braking System Notes:\n${data.knowledgeSharing.brakesNotes || "No notes provided"}`);
            summary.push(`\n### Wheels and Tyres Notes:\n${data.knowledgeSharing.wheelsNotes || "No notes provided"}`);
            
            // Self-Assessment
            summary.push("\n\n## SELF-ASSESSMENT");
            
            summary.push("\n### Confidence Ratings (1-5):");
            summary.push(`- Steering: ${data.assessment.ratings.steering}/5`);
            summary.push(`- Suspension: ${data.assessment.ratings.suspension}/5`);
            summary.push(`- Brakes: ${data.assessment.ratings.brakes}/5`);
            summary.push(`- Wheels & Tyres: ${data.assessment.ratings.wheelsAndTyres}/5`);
            
            summary.push("\n### Revision Priorities:");
            data.assessment.priorities.forEach(priority => {
                if (priority) summary.push(`- ${priority}`);
            });
            
            summary.push(`\n### Additional Notes:\n${data.assessment.additionalNotes || "No additional notes"}`);
            
            return summary.join('\n');
        }
        
        // Timer functionality - time tracker (counts up)
        function startTimer(display) {
            let seconds = 0;
            setInterval(function () {
                seconds++;
                
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                const remainingSeconds = seconds % 60;
                
                const formattedHours = hours < 10 ? "0" + hours : hours;
                const formattedMinutes = minutes < 10 ? "0" + minutes : minutes;
                const formattedSeconds = remainingSeconds < 10 ? "0" + remainingSeconds : remainingSeconds;
                
                display.textContent = formattedHours + ":" + formattedMinutes + ":" + formattedSeconds;
            }, 1000);
        }

        window.onload = function () {
            // Start timer
            const twoHours = 60 * 120; // 120 minutes in seconds
            const display = document.querySelector('#timer');
            startTimer(twoHours, display);
            
            // Load saved data if it exists
            try {
                const savedData = localStorage.getItem('chassisWorksheet');
                if (savedData) {
                    const shouldRestore = confirm("Found a previously saved session. Would you like to restore your work?");
                    if (shouldRestore) {
                        restoreData(JSON.parse(savedData));
                    }
                }
            } catch (e) {
                console.error("Error loading saved data:", e);
            }
        };
        
        // Restore saved data
        function restoreData(data) {
            // Restore system selection
            if (data.system) {
                const systemSelect = document.getElementById('system-select');
                systemSelect.value = data.system;
                const event = new Event('change');
                systemSelect.dispatchEvent(event);
            }
            
            // This is a simplified restoration - in a full implementation,
            // you'd restore all the form fields from the saved data
            alert("Your previous work has been restored! (Note: In this demo, only some data is restored)");
        }
    </script>
</body>
</html>
